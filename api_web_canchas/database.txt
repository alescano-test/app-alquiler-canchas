/* Creación del schema  */
CREATE SCHEMA sistema_reservas;

USE sistema_reservas;

/* Creación de tablas */

/*1er*/
CREATE TABLE usuarios (
  id_usuario INT PRIMARY KEY AUTO_INCREMENT,
  nombre VARCHAR(45) NOT NULL,
  apellido VARCHAR(45) NOT NULL,
  email VARCHAR(60) NOT NULL,
  contrasenia VARCHAR(45) NOT NULL,
  telefono VARCHAR(45) NOT NULL,
  rol VARCHAR(15) NOT NULL
);
/*2do*/
CREATE TABLE clubes (
  id_club INT PRIMARY KEY AUTO_INCREMENT,
  nombre VARCHAR(45) NOT NULL,
  direccion VARCHAR(100) NOT NULL,
  telefono VARCHAR(25) NOT NULL
);
/*3ro*/
CREATE TABLE canchas (
  id_cancha INT PRIMARY KEY AUTO_INCREMENT,
  club_id INT NOT NULL,
  tipo_deporte VARCHAR(60) NOT NULL,
  dimensiones VARCHAR(45) NOT NULL,
  precio INT NOT NULL,
  suelo VARCHAR(60) NOT NULL,
  INDEX id_tipo_deporte_idx (tipo_deporte),
  CONSTRAINT fk_clubes_canchas -- Relación entre `canchas` y `clubes`
  FOREIGN KEY (club_id) REFERENCES clubes (id_club)
);
/*4to*/
CREATE TABLE accesorios (
  id_accesorio INT PRIMARY KEY AUTO_INCREMENT,
  nombre VARCHAR(60) NOT NULL,
  tipo_deporte VARCHAR(60) NOT NULL,
  precio INT NOT NULL,
  estado VARCHAR(45),
  FOREIGN KEY (tipo_deporte) REFERENCES canchas (tipo_deporte)
);
/*5to*/
CREATE TABLE reservas (
  id_reserva INT PRIMARY KEY AUTO_INCREMENT,
  usuario_id INT NOT NULL,
  cancha_id INT NOT NULL,
  cant_jugadores INT NOT NULL,
  fecha DATE NOT NULL,
  hora TIME NOT NULL,
  estado_reserva VARCHAR(45) NOT NULL,
  CONSTRAINT fk_usuarios_reservas -- Relación entre `reservas` y `usuarios`
  FOREIGN KEY (usuario_id) REFERENCES usuarios (id_usuario),
  CONSTRAINT fk_canchas_reservas -- Relación entre `reservas` y `canchas`
  FOREIGN KEY (cancha_id) REFERENCES canchas (id_cancha)
);
/*6to*/
CREATE TABLE resenias (
    id_resenia INT PRIMARY KEY AUTO_INCREMENT,
    reserva_id INT NOT NULL,
    comentario VARCHAR(255) NOT NULL,
    calificacion INT NOT NULL,
    CONSTRAINT fk_reservas_resenias -- Relación entre `reseñas` y `reservas`
    FOREIGN KEY (reserva_id) REFERENCES reservas (id_reserva)
)